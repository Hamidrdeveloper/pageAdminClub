"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7807],{7807:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});n(9378);var a=n(68600),l=n(59678),r=n(24876),i=(n(91631),n(40416)),o=(n(95171),n(27378)),d=n(56552),c=n(46226),s=n(23280),m=n(72538),u=n(49989),p=n(48955),y=n(34234),_=n(19511),v=n(21329),E=n(39338),f=n(60071),g=n(62500),h=n(89261),Z=n(26761),b=(n(21267),n(59748)),O=function(e,t,n,a){function l(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{d(a.next(e))}catch(e){r(e)}}function o(e){try{d(a.throw(e))}catch(e){r(e)}}function d(e){e.done?n(e.value):l(e.value).then(i,o)}d((a=a.apply(e,t||[])).next())}))};const C=(0,E.cn)([]),I=(0,E.cn)(void 0),S=new y.Vx("contact-groups"),w=(0,b.el)((e=>({queryKey:["contactGroups",e(C)],queryFn:()=>O(void 0,void 0,void 0,(function*(){return(yield S.getAll({pagination:{per_page:50},params:{isActive:!0,supplierId:e(I)}})).data}))})));var F=function(e,t,n,a){function l(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{d(a.next(e))}catch(e){r(e)}}function o(e){try{d(a.throw(e))}catch(e){r(e)}}function d(e){e.done?n(e.value):l(e.value).then(i,o)}d((a=a.apply(e,t||[])).next())}))};const P=Z.ZP.span`
  margin-left: 8px;
  margin-right: 4px;
  transition: 0.3s all;
  cursor: ${e=>e.disabled?"not-allowed":"pointer"};
  opacity: ${e=>e.disabled?"0.7":"1"};

  &:hover {
    opacity: 0.7;
  }
`;var D=function({value:e,hasNew:t=!0,isMulti:n=!1,disabled:a=!1,menuPlacement:l="bottom",supplierId:r,onChange:i}){const[d,c]=(0,E.KO)(w),[,Z]=(0,E.KO)(I),[b,O]=(0,o.useState)("none"),[C,S]=(0,o.useState)(e),[D,V]=(0,o.useState)(""),{t:x}=(0,f.$)(),q=e=>null==i?void 0:i(e);return(0,o.useEffect)((()=>{r&&Z(r),c({type:"refetch"})}),[r]),o.createElement(o.Fragment,null,o.createElement(g.ZP,{isClearable:!0,isMulti:n,options:d,isLoading:!d||void 0,isDisabled:a,onChange:q,menuPlacement:l,getOptionValue:e=>String(e.id),theme:e=>(0,y.$p)(e),getOptionLabel:e=>(e=>{try{return e.address.address_complete.replace(/<br>/g,", ")}catch(e){return"No Title"}})(e),components:{Control:e=>{var t,n,a;return o.createElement(h.c.Control,Object.assign({},e),o.createElement(P,{disabled:!e.hasValue||!(null===(a=null===(n=null===(t=e.getValue())||void 0===t?void 0:t[0])||void 0===n?void 0:n.address)||void 0===a?void 0:a.address_complete),onMouseDown:t=>{var n,a,l,r,i,o;t.preventDefault(),t.stopPropagation(),e.hasValue&&(null===(l=null===(a=null===(n=e.getValue())||void 0===n?void 0:n[0])||void 0===a?void 0:a.address)||void 0===l?void 0:l.address_complete)&&(O("info"),V(null===(o=null===(i=null===(r=e.getValue())||void 0===r?void 0:r[0])||void 0===i?void 0:i.address)||void 0===o?void 0:o.address_complete))}},o.createElement(_.Z,{title:"Address Information"},o.createElement(s.Z,null)))," ",e.children)},Menu:e=>(0,u.S)({hasNew:t,props:e,onClick:()=>O("edit")}),IndicatorSeparator:()=>o.createElement("span",{style:{width:0}})},classNamePrefix:"react-select",value:C}),o.createElement(v.Z,{visible:"info"===b,footer:!1,destroyOnClose:!0,closable:!0,onCancel:()=>O("none")},o.createElement("div",{dangerouslySetInnerHTML:{__html:D}})),t&&o.createElement(p.Z,{isVisible:"edit"===b,setVisible:e=>O(e?"edit":"none"),title:"Global.ContactGroup"},o.createElement(m.default,{api:e=>F(this,void 0,void 0,(function*(){yield new y.Vx("contact-groups",x("Global.ContactGroup")).createOne(e),S(e),q(e)})),onCallback:()=>{c({type:"refetch"}),O("none")}})))},V=n(33996),x=n(32383),q=n(31675),k=n(3288),M=n(35062),A=n(10374),G=n(25724),T=n(28681);function L({onSubmit:e,isPending:t,initialValues:n}){const{t:d}=(0,f.$)(),[s]=k.Z.useForm(),[m,u]=(0,o.useState)();(0,o.useEffect)((()=>{n&&s.setFieldsValue(n)}),[n]);const[p,y]=(0,o.useState)({});return o.createElement(k.Z,{name:"purchase-form",form:s,layout:"vertical",onFinish:e},o.createElement(M.Z,{gutter:16},o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"supplier",label:d("Order.Field.SupplierName"),rules:[{required:!0}]},o.createElement(i.L,{onChange:e=>u(e)}))),o.createElement(A.Z,{span:12},o.createElement(o.Suspense,{fallback:(0,x.Z)(d("Order.Field.Company"))},o.createElement(k.Z.Item,{name:"company",label:d("Order.Field.Company"),rules:[{required:!0}]},o.createElement(c.Z,{showOnlyMainCompanies:!0,isClearable:!1,onChange:e=>{y({company_id:e.id});const t=s.getFieldsValue();s.setFieldsValue(Object.assign(Object.assign({},t),{payment_method:null}))}})))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"payment_method",label:d("Order.Field.PaymentMethod"),rules:[{required:!0}]},o.createElement(a.m,{filter:p}))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"invoice_contact_group",label:d("Order.Field.InvoiceContactGroupAddress"),rules:[{required:!0}]},o.createElement(D,{supplierId:null==m?void 0:m.id}))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"delivery_contact_group",label:d("Order.Field.DeliveryContactGroup"),rules:[{required:!0}]},o.createElement(D,null))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"early_payment_discount_days",label:d("Order.Field.EarlyPaymentDiscountDays"),rules:[{required:!1}]},o.createElement(G.Z,null))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"early_payment_discount_percentage",label:d("Order.Field.EarlyPaymentDiscountPercentage"),rules:[{required:!1}]},o.createElement(G.Z,{min:0,max:100}))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"shipping_profile",label:d("Order.Field.ShippingProfile")},o.createElement(r.X,null))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"delivery_date",label:d("Order.Field.DeliveryDate")},o.createElement(T.Z,{format:(0,q._A)()}))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"estimate_payment_date",label:d("Order.Field.EstimatedPaymentDate")},o.createElement(T.Z,{format:(0,q._A)()}))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"payment_term",label:d("Order.Field.PaymentTerm")},o.createElement(l.u,null))),o.createElement(A.Z,{span:12},o.createElement(k.Z.Item,{name:"pay_date",label:d("Order.Field.PayDate")},o.createElement(T.Z,{format:(0,q._A)()})))),o.createElement(V.Ow,{isPending:t}))}n(73675);var N=n(68326);var $=({onCallback:e})=>{const t=new N.ZP,{mutate:n,isLoading:a}=(0,d.useMutation)((({values:e})=>t.apiService.createOne(e)));return o.createElement(L,{onSubmit:t=>{var a,l;n({values:{company_id:t.company.id,supplier_id:t.supplier.id,invoice_contact_group_id:t.invoice_contact_group.id,delivery_contact_group_id:t.delivery_contact_group.id,payment_method_id:t.payment_method.id,early_payment_discount_days:t.early_payment_discount_days,early_payment_discount_percentage:t.early_payment_discount_percentage,payment_status:t.payment_status,shipping_profile_id:null===(a=t.shipping_profile)||void 0===a?void 0:a.id,delivery_date:t.delivery_date?new Date(t.delivery_date).toISOString().split("T")[0]:void 0,estimate_payment_date:t.estimate_payment_date?new Date(t.estimate_payment_date).toISOString().split("T")[0]:void 0,incoming_items:void 0,payment_term_id:null===(l=t.payment_term)||void 0===l?void 0:l.id,pay_date:t.pay_date?new Date(t.pay_date).toISOString().split("T")[0]:void 0}},{onSuccess:e})},isPending:a})}}}]);